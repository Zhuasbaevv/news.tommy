<

<div class="news-card">
    <button class="del-btn" style="display:block" onclick="deletePost(this)">[–£–¥–∞–ª–∏—Ç—å]</button>
    <div class="news-title">–ü–µ—Ä–≤—ã–π –ø–æ—Å—Ç –Ω–∞—à–µ–≥–æ —Å–∞–π—Ç–∞</div>
    <img src="–ë–µ–∑ –º–æ–µ–≥–æ.jpg">
    <div class="photo-credit">–§–æ—Ç–æ: –ò—Å—Ç–æ—á–Ω–∏–∫ –Ω–æ–≤–æ—Å—Ç–∏</div>
    <div class="news-content"><p>–í–∏–Ω—á–µ–Ω—Ü–æ</p></div>
</div>
        <div class="news-card">
            <div class="news-title">–í –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–µ –∑–∞–ø—É—Å—Ç–∏–ª–∏ –Ω–æ–≤—ã–π –Ω–æ–≤–æ—Å—Ç–Ω–æ–π –ø–æ—Ä—Ç–∞–ª</div>
            <div class="news-content">
                <p>–¢–µ–ø–µ—Ä—å —Å–ª–µ–¥–∏—Ç—å –∑–∞ —Å–æ–±—ã—Ç–∏—è–º–∏ —Å—Ç–∞–ª–æ –ø—Ä–æ—â–µ. –°–∞–π—Ç Tommy News –Ω–∞—á–∞–ª —Å–≤–æ—é —Ä–∞–±–æ—Ç—É –≤ —Ç–µ—Å—Ç–æ–≤–æ–º —Ä–µ–∂–∏–º–µ.</p>
            </div>
        </div>
    
    </div>
</div>

<nav class="bottom-nav">
    <div class="nav-item active"><div>üì∞</div>NEWS</div>
    <div class="nav-item"><div>‚öΩ</div>SPORT</div>
    <div class="nav-item"><div>üè•</div>HEALTH</div>
    <div class="nav-item"><div>üöó</div>AUTO</div>
    <div class="nav-item"><div>‚öôÔ∏è</div>–ú–ï–ù–Æ</div>
</nav>

<script>
    let GITHUB_TOKEN = "";
    const REPO = "Zhuasbaevv/news.tommy";
    let clicks = 0;

    function handleSecretClick() {
        clicks++;
        if (clicks === 5) {
            GITHUB_TOKEN = prompt("–í–≤–µ–¥–∏—Ç–µ —Ç–æ–∫–µ–Ω –¥–æ—Å—Ç—É–ø–∞:");
            if (GITHUB_TOKEN) {
                document.getElementById('admin-panel').style.display = 'block';
                document.querySelectorAll('.del-btn').forEach(b => b.style.display = 'block');
            }
            clicks = 0;
        }
    }

    async function publishNews() {
        const title = document.getElementById('post-title').value;
        const img = document.getElementById('img-url').value;
        const text = document.getElementById('news-text').value;

        const newHtml = `
<div class="news-card">
    <button class="del-btn" style="display:block" onclick="deletePost(this)">[–£–¥–∞–ª–∏—Ç—å]</button>
    <div class="news-title">${title}</div>
    ${img ? `<img src="${img}">` : ''}
    <div class="photo-credit">–§–æ—Ç–æ: –ò—Å—Ç–æ—á–Ω–∏–∫ –Ω–æ–≤–æ—Å—Ç–∏</div>
    <div class="news-content"><p>${text.replace(/\n/g, '<br>')}</p></div>
</div>`;

        document.getElementById('news-container').insertAdjacentHTML('afterbegin', newHtml);
        await saveToGithub();
    }

    async function deletePost(btn) {
        if(confirm("–£–¥–∞–ª–∏—Ç—å –Ω–æ–≤–æ—Å—Ç—å?")) {
            btn.parentElement.remove();
            await saveToGithub();
        }
    }

    async function saveToGithub() {
        try {
            const res = await fetch(`https://api.github.com/repos/${REPO}/contents/index.html`);
            const data = await res.json();
            const currentCode = decodeURIComponent(escape(atob(data.content)));

            const newContent = document.getElementById('news-container').innerHTML;
            const startTag = "";
            
            // –°–æ–±–∏—Ä–∞–µ–º –∫–æ–¥ –æ–±—Ä–∞—Ç–Ω–æ
            const before = currentCode.split(startTag)[0];
            const after = currentCode.split('</div>\n</div>\n\n<nav')[1];
            
            const finalCode = before + startTag + "\n" + newContent + "\n    </div>\n</div>\n\n<nav" + after;

            await fetch(`https://api.github.com/repos/${REPO}/contents/index.html`, {
                method: "PUT",
                headers: { "Authorization": `token ${GITHUB_TOKEN}`, "Content-Type": "application/json" },
                body: JSON.stringify({
                    message: "New post added",
                    content: btoa(unescape(encodeURIComponent(finalCode))),
                    sha: data.sha
                })
            });
            alert("–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ! –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —á–µ—Ä–µ–∑ –º–∏–Ω—É—Ç—É.");
            location.reload();
        } catch (e) { alert("–û—à–∏–±–∫–∞: " + e); }
    }
</script>
</body>
</html>
